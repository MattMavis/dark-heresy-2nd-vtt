{{#with rollData}}
    <div class="dh-wrapper">
        <div class="dh-chat">
            <h3>Attack Roll</h3>
            <div class="dh-roll">
                <h1>{{weapon.name}}</h1>
                <h2>{{action}}</h2>
                <h2>{{lookup difficulties difficulty}}</h2>
                <div class="dh-roll__divider"></div>

                <div class="dh-roll__row dh-roll__row--number">
                    <div class="dh-roll__label">Base</div>
                    <div class="dh-roll__value">{{baseTarget}}</div>
                </div>
                {{#each activeModifiers}}
                    <div class="dh-roll__row dh-roll__row--number">
                        <div class="dh-roll__label">Modifier: {{@key}}</div>
                        <div class="dh-roll__value">{{this}}</div>
                    </div>
                {{/each}}
                <div class="dh-roll__target">
                    <div class="dh-roll__label">Target</div>
                    <div class="dh-roll__value">{{modifiedTarget}}</div>
                </div>

                {{#if success}}
                    <button class="dh-roll__success roll-control__hide-control" data-toggle="{{rollId}}">
                        <span>Success</span>
                        <span>{{roll.total}}</span>
                    </button>
                    <div class="dh-roll__row dh-roll__row--number">
                        <div class="dh-roll__label">Degrees of Success</div>
                        <div class="dh-roll__value">{{dos}}</div>
                    </div>
                {{else}}
                    <div class="dh-roll__fail">
                        <span>Fail</span>
                        <span>{{roll.total}}</span>
                    </div>
                    <div class="dh-roll__row dh-roll__row--number">
                        <div class="dh-roll__label">Degrees of Failure</div>
                        <div class="dh-roll__value">{{dof}}</div>
                    </div>
                {{/if}}
            </div>
        </div>
    </div>
{{/with}}

{{#if rollData.success}}
    {{#with damageData}}
        <div class="dh-wrapper" id="{{rollId}}" style='display: none'>
            <div class="dh-chat">
                <h3>Damage</h3>
                <div class="dh-roll">
                    {{#each hits as |hit|}}
                        {{#each modifiers}}
                            <div class="dh-roll__row dh-roll__row--number">
                                <div class="dh-roll__label">Modifier: {{@key}}</div>
                                <div class="dh-roll__value">{{this}}</div>
                            </div>
                        {{/each}}
                        <div class="dh-roll__row dh-roll__row--number">
                            <div class="dh-roll__label">Damage</div>
                            <div class="dh-roll__value">{{hit.totalDamage}}</div>
                        </div>
                        {{#each penetrationModifiers}}
                            <div class="dh-roll__row dh-roll__row--number">
                                <div class="dh-roll__label">Modifier: {{@key}}</div>
                                <div class="dh-roll__value">{{this}}</div>
                            </div>
                        {{/each}}
                        <div class="dh-roll__row dh-roll__row--number">
                            <div class="dh-roll__label">Penetration</div>
                            <div class="dh-roll__value">{{hit.totalPenetration}}</div>
                        </div>
                        <div class="dh-roll__divider"></div>
                    {{/each}}
                </div>
            </div>
        </div>
    {{/with}}
{{/if}}
